---
title: "1/_f_ noise is related to age, but not short-term memory or sensorimotor reaction time."
author: "Jan Freyberg"
email: jan.freyberg@kcl.ac.uk
department: Forensic and Neurodevelopmental Sciences, King's College London
address: 16 De Crespigny Park, SE5 8AF London, UK
date: "12/05/2017"
output:
  pdf_document:
    template: ccn_style.tex
    fig_caption: true

header-includes:
  - \usepackage{hyperref}

abstract: 
  "Recent evidence points towards an increase in 1/_f_ neural noise (noise with decreasing power in higher frequency bands) with age. Previous evidence related this increase to a decrease in working memory performance. Here, we attempted to replicate previous findings with data from the Cam-CAN project. We used two minutes of a resting-state recording to estimate the power-spectral density of neural activity. We then correlated the $\\mathbf{\\beta}$ of a regression of noise on frequency with age, sensorimotor reaction times, and short-term memory performance. We reproduced previously demonstrated increases in 1/_f_ noise with age, but did not find a relationship with working memory performance, indicating that it may not be important in cognitive decline in ageing."

keywords: MEG; noise; ageing
bibliography: /Users/jan/Documents/Zotero/better-bibtex/zotero-library.bib
---

```{r setup, include=FALSE}
# for plotting:
library(png)
library(grid)
library(gridExtra)
library(jpeg)
library(ggplot2)
library(viridis)

# for printing
library(apa)
library(stringr)

# for data processing:
library(readr)
library(stringr)
library(dplyr)
library(tidyr)
library(magrittr)

# load the data for the two MEG recordings
task.data <- read_csv('../csv/task.csv') %>%
  filter(removed_elecs < 0.2*204)
rest.data <- read_csv('../csv/rest.csv') %>%
  filter(removed_elecs < 0.2*204)
both.data <- inner_join(task.data, rest.data, by=c('pid', 'sex', 'age'), suffix=c('.task', '.rest'))

# add the MEG behavioral data
task.data <- inner_join(task.data, read_csv('../csv/megbehavior.csv'))
# add the VSTM behavioral data
task.data <- read_csv('../csv/vstm-behavior.csv') %>%
  rename(pid = CCID) %>%
  mutate(Prcsn_ss1 = as.numeric(Prcsn_ss1),
         Prcsn_ss2 = as.numeric(Prcsn_ss2),
         Prcsn_ss3 = as.numeric(Prcsn_ss3),
         Prcsn_ss4 = as.numeric(Prcsn_ss4),
         Doubt_ss1 = as.numeric(Doubt_ss1),
         Doubt_ss2 = as.numeric(Doubt_ss2),
         Doubt_ss3 = as.numeric(Doubt_ss3),
         Doubt_ss4 = as.numeric(Doubt_ss4),
         Prcsn_PerceptionTest = as.numeric(Prcsn_PerceptionTest)) %>%
  inner_join(task.data)

# load the spectrum data for age split:
age.split.spectra <- read_csv('../csv/agesplit-spectra.csv') %>%
  gather(frequency, power, -pid, -group) %>%
  mutate(frequency = as.numeric(frequency)) %>%
  mutate(group = str_replace(group, 'old', 'Oldest 25%')) %>%
  mutate(group = str_replace(group, 'young', 'Youngest 25%')) %>%
  mutate(group = factor(group, levels = c('Youngest 25%', 'Oldest 25%')))

# load the vstm behavior data'vstm-behavior.csv'

```

# Introduction

One feature of the power spectrum of human brain activity obtained through electrophysiological imaging is a decrease in power with increasing frequency. This relationship between power and the inverse of frequency (often described as 1/_f_, or pink, noise) has recently been linked to ageing [@voytek_age-related_2015]. Voytek and colleagues found that the linear relationship between frequency and noise was steeper in younger individuals, with less electrophysiological noise in high frequency bands. They were able to show this relationship using both intracranial electrocorticography (ECoG) and electroencephalography (EEG). Voytek and colleagues also demonstrated a relationship between the levels of 1/_f_ noise and visual working memory, and that 1/_f_ noise mediates impairments of visual working memory in ageing.

Here, we wanted to reproduce the finding and test its central hypoethis of a relationship between  in a public dataset: the Cambridge Center for Ageing and Neuroscience data repository [Cam-CAN, @taylor_cambridge_2017]. We therefore tried to replicate the finding of 1/_f_ noise increasing in age, as well as the relationship between 1/_f_ noise and working memory performance.

# Methods

The Cam-CAN Stage 2 release includes one 8m40s resting-state and one 8m40s sensorimotor task MEG recordings for 647 participants. Resting-state recordings were conducted with eyes closed, and the sensorimotor task required button response to bilateral sine grating and concurrent audio tone presentation. Participants also completed behavioural tasks outside the MEG scanner. Here, we analysed a visual short term memory task: matching a sequence of hues, storing 1 to 4 hues in short-term memory.

MEG recording methods are fully described in Taylor et al. [-@taylor_cambridge_2017]. Out of 647, we analysed `r nrow(rest.data)` resting-state and `r nrow(task.data)` task recordings. This subset of subjects had an average age of `r task.data %$% mean(age) %>% round(digits=1)` years (st.dev.: `r task.data %$% sd(age) %>% round(digits=1)`, range: `r task.data %$% min(age)`-`r task.data %$% max(age)`).

All data analysis was performed using `MNE-python` [@gramfort_mne_2014, @gramfort_meg_2013]. We chose a random two-minute segment from the full recording. We performed temporal space-signal separation [tSSS, @taulu_applications_2005, correlation threshold 0.98; 10-sec sliding window], followed by ICA decomposition and removal of ICA components based on the highest correlation with the HEOG, VEOG and ECG channels. We then computed the log of the power-spectrum from 2 Hz to 7 Hz and from 14 Hz to 24 Hz, avoiding the alpha range [see @voytek_age-related_2015], using Welch's method (2 s sliding window, 50% overlap). We calculated a linear regression of this semi-log data for each gradiometer for each individual and removed any electrodes in which the intercept of this linear regression was two standard-deviations above or below the average for an individual was removed. We performed correlation analyses between the regression slope and age, sensorimotor reaction times and short-term memory.

# Results

```{r test stats, echo=FALSE}
# helper function
fmt_tex <- function(text){
  str_replace(paste0("$", apa(text, format='text'), "$"), ', ', '$, $')
}

age.slope.cor <- task.data %$% cor.test(age, average.slope, method='p') %>% fmt_tex()
age.intercept.cor <- task.data %$% cor.test(age, average.intercept, method='p') %>% fmt_tex()
rt.slope.cor <- task.data %$% cor.test(mean.rt, average.slope, method='p') %>% fmt_tex()
vstm.slope.cor <- task.data %$% cor.test(Prcsn_ss4, average.slope, method='p') %>% fmt_tex()
rest.slope.task.cor <- both.data %$% cor.test(average.slope.rest, average.slope.task, method='p') %>% fmt_tex()

```

```{r, echo=FALSE, fig.width=3.3, fig.height=2.6, fig.pos='B'}
p <- ggplot(task.data, aes(x=age, y=average.slope, color=age)) +
  geom_smooth(method=lm, color='gray') +
  labs(y = "Average Slope", color='Age\n', x = "Age (years)") +
  geom_point(size=1.2, show.legend = FALSE) +
  scale_color_viridis() +
  theme_bw() +
  scale_x_continuous(expand = c(0, 0)) +
  theme(axis.text.y = element_text(face="bold", size=6, angle=90),
        axis.text.x = element_text(face="bold", size=6),
        legend.position = 'bottom')

p
```

###### _Figure 1: Relationship between 1/f noise during a sensorimotor task and age._ {#fig-slope-age}

The relationship between 1/_f_ noise slope and age replicated ([Figure 1](#fig-slope-age), `r age.slope.cor`). There was however no evidence for a relationship between 1/_f_ noise and visual short term memory ([Figure 2](#fig-slope-rt), `r vstm.slope.cor`) or visual short-term memory (`r rt.slope.cor`).

We also found no relationship between the 1/_f_ noise slope during resting state and task (`r rest.slope.task.cor`). We did, however, find a relationship between 

To visualise this further, we plotted the power spectrum between 2 and 24 Hz for the top and bottom age quartile of our sample, demonstrating that there is no overall difference in the power spectra, and that the linear fall-off of log$_{10}$(power) with frequency is equivalent in the youngest and oldest age groups.



```{r, echo=FALSE, fig.width=3.3, fig.height=2.6, warning=FALSE}
p <- ggplot(task.data, aes(x=mean.rt, y=average.slope, color=age)) +
  geom_smooth(method=lm, color='gray') +
  geom_point(size=1.2, show.legend=FALSE) +
  scale_color_viridis() +
  labs(x = "Sensorimotor Reaction Time (s)", y = "Average Slope", color='Age\n') +
  theme_bw() +
  scale_x_continuous(expand = c(0, 0)) +
  theme(axis.text.y = element_text(face="bold", size=6, angle=90),
        axis.text.x = element_text(face="bold", size=6),
        legend.position = 'bottom')

p
```

###### _Figure 2: No relationship between 1/f noise and reaction times._ {#fig-slope-rt}

```{r, echo=FALSE, fig.width=3.3, fig.height=2.6, warning=FALSE}
p <- task.data %>%
  filter(Prcsn_ss4 <= 1) %>%
  ggplot(aes(x=Prcsn_ss4, y=average.slope, color=age)) +
  geom_smooth(method=lm, color='gray') +
  geom_point(size=1.2, show.legend=FALSE) +
  scale_color_viridis() +
  labs(x = "Sensorimotor Reaction Time (s)", y = "Average Slope", color='Age\n') +
  theme_bw() +
  scale_x_continuous(expand = c(0, 0)) +
  theme(axis.text.y = element_text(face="bold", size=6, angle=90),
        axis.text.x = element_text(face="bold", size=6),
        legend.position = 'bottom')

p
```

###### _Figure 3: No relationship between 1/f noise and short-term memory._ {#fig-slope-memory}

```{r, echo=FALSE, fig.width=3.3, fig.height=2.6}
p <- ggplot(age.split.spectra, aes(x=frequency, y=power, group=group, color=group)) +
  stat_summary(fun.y='mean', geom = 'line') +
  geom_ribbon(stat='summary', fun.data='mean_se',
              aes(fill=group), alpha=0.3, size=0,
              show.legend = FALSE) +
  labs(group = '', x = 'Frequency', y = 'Power') +
  theme_bw() +
  scale_fill_manual(values = viridis(2, begin=0.25, end=0.75)) +
  scale_color_manual(values = viridis(2, begin=0.125, end=0.875)) +
  scale_x_continuous(expand = c(0, 0)) +
  theme(axis.text.y = element_text(face="bold", size=6, angle=90),
        axis.text.x = element_text(face="bold", size=6),
        legend.title = element_blank(),
        legend.position = c(0.7, 0.85),
        legend.background = element_blank(),
        legend.box.background = element_blank())

p
```

###### _Figure 4: Equivalent power spectra in the top and bottom age quartiles._ {#fig-spectrum}

# Conclusions

This analysis did not confirm reports of increased 1/_f_ noise with age. We also found no evidence for a relationship between 1/_f_ noise with visual short-term memory, or sensorimotor reaction times. This difference between this and previous reports may stem from differences in methodology: First, this report utilised MEG data from a sensorimotor task and resting-state data, while Voytek and colleagues used ECoG data from a short-term memory task, and resting state EEG data. Second, this report used MEG data. Third, the tasks were not 100% equivalent between papers.

Behavioral states have been shown to modulate 1/_f_ noise [@podvalny_unifying_2015], something which was true in this report. The differences in task between this and previous reports may therefore contribute to the difference in results. Additionally, we analysed a visual short-term memory task in analogy to previous work by Voytek at al. [-@voytek_age-related_2015]. However, this task was in fact done separately to the MEG sessions, which likely contributed to the lack of relationship between the 1/_f_ noise and task performance.

We believe that this report illustrates that the link between age and 1/_f_ noise may not be robust.

# References
